#!/bin/bash

# DevTool - Naver Real Estate ê°œë°œ ë„êµ¬ í†µí•© ê´€ë¦¬
# Scripts, Tests, Database, Monitoringì„ í•˜ë‚˜ì˜ ì¸í„°í˜ì´ìŠ¤ë¡œ ê´€ë¦¬

PROJECT_ROOT="/Users/specialrisk_mac/code_work/naver_realestate"
cd "$PROJECT_ROOT"

# ìƒ‰ìƒ ì •ì˜
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
BOLD='\033[1m'
NC='\033[0m' # No Color

# í—¤ë” ì¶œë ¥
print_header() {
    clear
    echo -e "${CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${CYAN}â•‘                                                        â•‘${NC}"
    echo -e "${CYAN}â•‘${NC}     ${BOLD}${PURPLE}ğŸ› ï¸  Naver Real Estate DevTool${NC}              ${CYAN}â•‘${NC}"
    echo -e "${CYAN}â•‘${NC}        ${BLUE}í†µí•© ê°œë°œ ë„êµ¬ & ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ${NC}           ${CYAN}â•‘${NC}"
    echo -e "${CYAN}â•‘                                                        â•‘${NC}"
    echo -e "${CYAN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
}

# ìƒíƒœ ì²´í¬
check_status() {
    echo -e "${BOLD}${BLUE}ğŸ“Š ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""

    # Docker ìƒíƒœ
    if docker ps 2>/dev/null | grep -q "postgres"; then
        echo -e "  ${GREEN}âœ… PostgreSQL${NC} (í¬íŠ¸ 5433)"
    else
        echo -e "  ${RED}âŒ PostgreSQL${NC} - docker-compose up -dë¡œ ì‹œì‘í•˜ì„¸ìš”"
    fi

    if docker ps 2>/dev/null | grep -q "redis"; then
        echo -e "  ${GREEN}âœ… Redis${NC} (í¬íŠ¸ 6380)"
    else
        echo -e "  ${RED}âŒ Redis${NC} - docker-compose up -dë¡œ ì‹œì‘í•˜ì„¸ìš”"
    fi

    # Backend API
    if curl -s http://localhost:8000/health > /dev/null 2>&1; then
        echo -e "  ${GREEN}âœ… Backend API${NC} (í¬íŠ¸ 8000)"
    else
        echo -e "  ${YELLOW}âš ï¸  Backend API${NC} - ì‹¤í–‰ë˜ì§€ ì•ŠìŒ"
    fi

    # Frontend
    if curl -s http://localhost:3000 > /dev/null 2>&1; then
        echo -e "  ${GREEN}âœ… Frontend${NC} (í¬íŠ¸ 3000)"
    else
        echo -e "  ${YELLOW}âš ï¸  Frontend${NC} - ì‹¤í–‰ë˜ì§€ ì•ŠìŒ"
    fi

    # Celery Worker
    if pgrep -f "celery.*worker" > /dev/null 2>&1; then
        echo -e "  ${GREEN}âœ… Celery Worker${NC}"
    else
        echo -e "  ${YELLOW}âš ï¸  Celery Worker${NC} - ì‹¤í–‰ë˜ì§€ ì•ŠìŒ"
    fi

    # Celery Beat
    if pgrep -f "celery.*beat" > /dev/null 2>&1; then
        echo -e "  ${GREEN}âœ… Celery Beat${NC}"
    else
        echo -e "  ${YELLOW}âš ï¸  Celery Beat${NC} - ì‹¤í–‰ë˜ì§€ ì•ŠìŒ"
    fi

    echo ""
}

# ë©”ì¸ ë©”ë‰´
show_main_menu() {
    print_header
    check_status

    echo -e "${BOLD}${CYAN}ğŸ“‹ ë©”ì¸ ë©”ë‰´${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "  ${GREEN}${BOLD}1)${NC} ğŸ—„ï¸  ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬"
    echo -e "  ${GREEN}${BOLD}2)${NC} ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰"
    echo -e "  ${GREEN}${BOLD}3)${NC} ğŸ“Š ëª¨ë‹ˆí„°ë§ & ìƒíƒœ í™•ì¸"
    echo -e "  ${GREEN}${BOLD}4)${NC} ğŸš€ ì„œë¹„ìŠ¤ ê´€ë¦¬"
    echo -e "  ${GREEN}${BOLD}5)${NC} ğŸ“š ë¬¸ì„œ ë³´ê¸°"
    echo ""
    echo -e "  ${RED}${BOLD}0)${NC} ğŸšª ì¢…ë£Œ"
    echo ""
    echo -e -n "${BOLD}ì„ íƒ${NC} â¤ "
    read choice

    case $choice in
        1) database_menu ;;
        2) test_menu ;;
        3) monitoring_menu ;;
        4) service_menu ;;
        5) docs_menu ;;
        0)
            echo ""
            echo -e "${GREEN}ğŸ‘‹ DevToolì„ ì¢…ë£Œí•©ë‹ˆë‹¤.${NC}"
            echo ""
            exit 0
            ;;
        *)
            echo -e "${RED}âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤${NC}"
            sleep 1
            show_main_menu
            ;;
    esac
}

# ë°ì´í„°ë² ì´ìŠ¤ ë©”ë‰´
database_menu() {
    print_header
    echo -e "${BOLD}${CYAN}ğŸ—„ï¸  ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "  ${GREEN}${BOLD}1)${NC} ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ë‚´ìš© í™•ì¸ ${BLUE}(check_data.py)${NC}"
    echo -e "  ${GREEN}${BOLD}2)${NC} ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜ ${BLUE}(migrate_db.py)${NC}"
    echo -e "  ${GREEN}${BOLD}3)${NC} ğŸ—‘ï¸  ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ${RED}[ìœ„í—˜]${NC} ${BLUE}(reset_db.py)${NC}"
    echo -e "  ${GREEN}${BOLD}4)${NC} ğŸ˜ PostgreSQL ì ‘ì† ${BLUE}(psql)${NC}"
    echo ""
    echo -e "  ${YELLOW}${BOLD}0)${NC} â¬…ï¸  ë’¤ë¡œê°€ê¸°"
    echo ""
    echo -e -n "${BOLD}ì„ íƒ${NC} â¤ "
    read choice

    case $choice in
        1)
            echo ""
            backend/.venv/bin/python scripts/check_data.py
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            database_menu
            ;;
        2)
            echo ""
            echo -e "${YELLOW}âš ï¸  ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ì„ ì¶”ê°€í•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)${NC}"
            echo -e -n "${BOLD}í™•ì¸${NC} â¤ "
            read confirm
            if [[ "$confirm" == "y" || "$confirm" == "Y" ]]; then
                backend/.venv/bin/python scripts/migrate_db.py
            else
                echo -e "${BLUE}â„¹ï¸  ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.${NC}"
            fi
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            database_menu
            ;;
        3)
            echo ""
            echo -e "${RED}${BOLD}âš ï¸âš ï¸âš ï¸  ê²½ê³ : ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤! âš ï¸âš ï¸âš ï¸${NC}"
            echo -e "${RED}ì •ë§ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (yes ì…ë ¥ í•„ìš”)${NC}"
            echo -e -n "${BOLD}í™•ì¸${NC} â¤ "
            read confirm
            if [[ "$confirm" == "yes" ]]; then
                backend/.venv/bin/python scripts/reset_db.py
            else
                echo -e "${BLUE}â„¹ï¸  ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.${NC}"
            fi
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            database_menu
            ;;
        4)
            echo ""
            docker exec -it naver_realestate-postgres-1 psql -U postgres -d naver_realestate
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            database_menu
            ;;
        0) show_main_menu ;;
        *)
            echo -e "${RED}âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤${NC}"
            sleep 1
            database_menu
            ;;
    esac
}

# í…ŒìŠ¤íŠ¸ ë©”ë‰´
test_menu() {
    print_header
    echo -e "${BOLD}${CYAN}ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "  ${GREEN}${BOLD}1)${NC} ğŸŒ API í…ŒìŠ¤íŠ¸ ${BLUE}(test_api.sh)${NC}"
    echo -e "  ${GREEN}${BOLD}2)${NC} ğŸ’° ì‹¤ê±°ë˜ê°€ API í…ŒìŠ¤íŠ¸ ${BLUE}(test_transaction_api.sh)${NC}"
    echo -e "  ${GREEN}${BOLD}3)${NC} ğŸ’¬ Discord ë¸Œë¦¬í•‘ í…ŒìŠ¤íŠ¸ ${BLUE}(test_discord_briefing.sh)${NC}"
    echo -e "  ${GREEN}${BOLD}4)${NC} ğŸ”„ ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰"
    echo ""
    echo -e "  ${YELLOW}${BOLD}0)${NC} â¬…ï¸  ë’¤ë¡œê°€ê¸°"
    echo ""
    echo -e -n "${BOLD}ì„ íƒ${NC} â¤ "
    read choice

    case $choice in
        1)
            echo ""
            ./tests/test_api.sh
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            test_menu
            ;;
        2)
            echo ""
            ./tests/test_transaction_api.sh
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            test_menu
            ;;
        3)
            echo ""
            ./tests/test_discord_briefing.sh
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            test_menu
            ;;
        4)
            echo ""
            echo -e "${BLUE}${BOLD}ğŸ”„ ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹œì‘...${NC}"
            echo ""
            ./tests/test_api.sh
            echo ""
            ./tests/test_transaction_api.sh
            echo ""
            ./tests/test_discord_briefing.sh
            echo ""
            echo -e "${GREEN}${BOLD}âœ… ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ${NC}"
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            test_menu
            ;;
        0) show_main_menu ;;
        *)
            echo -e "${RED}âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤${NC}"
            sleep 1
            test_menu
            ;;
    esac
}

# ëª¨ë‹ˆí„°ë§ ë©”ë‰´
monitoring_menu() {
    print_header
    echo -e "${BOLD}${CYAN}ğŸ“Š ëª¨ë‹ˆí„°ë§ & ìƒíƒœ í™•ì¸${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "  ${GREEN}${BOLD}1)${NC} ğŸ“… ìŠ¤ì¼€ì¤„ & í¬ë¡¤ë§ ìƒíƒœ ${BLUE}(check_schedules.sh)${NC}"
    echo -e "  ${GREEN}${BOLD}2)${NC} ğŸ“œ ë¡œê·¸ ì‹¤ì‹œê°„ ë³´ê¸° ${BLUE}(logs_all.sh)${NC}"
    echo -e "  ${GREEN}${BOLD}3)${NC} ğŸ³ Docker ì»¨í…Œì´ë„ˆ ìƒíƒœ"
    echo -e "  ${GREEN}${BOLD}4)${NC} ğŸ” í”„ë¡œì„¸ìŠ¤ ìƒíƒœ ${BLUE}(ps)${NC}"
    echo -e "  ${GREEN}${BOLD}5)${NC} ğŸŒ ì›¹ UI ì—´ê¸°"
    echo ""
    echo -e "  ${YELLOW}${BOLD}0)${NC} â¬…ï¸  ë’¤ë¡œê°€ê¸°"
    echo ""
    echo -e -n "${BOLD}ì„ íƒ${NC} â¤ "
    read choice

    case $choice in
        1)
            echo ""
            ./scripts/check_schedules.sh
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            monitoring_menu
            ;;
        2)
            echo ""
            ./logs_all.sh
            ;;
        3)
            echo ""
            docker ps
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            monitoring_menu
            ;;
        4)
            echo ""
            echo -e "${BLUE}${BOLD}Backend API:${NC}"
            ps aux | grep "uvicorn" | grep -v grep || echo "  ${YELLOW}ì‹¤í–‰ ì¤‘ì´ ì•„ë‹˜${NC}"
            echo ""
            echo -e "${BLUE}${BOLD}Celery Worker:${NC}"
            ps aux | grep "celery.*worker" | grep -v grep || echo "  ${YELLOW}ì‹¤í–‰ ì¤‘ì´ ì•„ë‹˜${NC}"
            echo ""
            echo -e "${BLUE}${BOLD}Celery Beat:${NC}"
            ps aux | grep "celery.*beat" | grep -v grep || echo "  ${YELLOW}ì‹¤í–‰ ì¤‘ì´ ì•„ë‹˜${NC}"
            echo ""
            echo -e "${BLUE}${BOLD}Frontend:${NC}"
            ps aux | grep "next-server" | grep -v grep || echo "  ${YELLOW}ì‹¤í–‰ ì¤‘ì´ ì•„ë‹˜${NC}"
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            monitoring_menu
            ;;
        5)
            echo ""
            echo -e "${BLUE}${BOLD}ğŸŒ ì›¹ UI ì—´ê¸°...${NC}"
            open http://localhost:3000 2>/dev/null || xdg-open http://localhost:3000 2>/dev/null || echo "ë¸Œë¼ìš°ì €ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì—´ì–´ì£¼ì„¸ìš”: http://localhost:3000"
            open http://localhost:8000/docs 2>/dev/null || xdg-open http://localhost:8000/docs 2>/dev/null
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            monitoring_menu
            ;;
        0) show_main_menu ;;
        *)
            echo -e "${RED}âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤${NC}"
            sleep 1
            monitoring_menu
            ;;
    esac
}

# ì„œë¹„ìŠ¤ ê´€ë¦¬ ë©”ë‰´
service_menu() {
    print_header
    echo -e "${BOLD}${CYAN}ğŸš€ ì„œë¹„ìŠ¤ ê´€ë¦¬${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "  ${GREEN}${BOLD}1)${NC} ğŸŸ¢ ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘ ${BLUE}(start_all.sh)${NC}"
    echo -e "  ${GREEN}${BOLD}2)${NC} ğŸ”´ ëª¨ë“  ì„œë¹„ìŠ¤ ì¤‘ì§€ ${BLUE}(stop_all.sh)${NC}"
    echo -e "  ${GREEN}${BOLD}3)${NC} ğŸ”„ Docker ì»¨í…Œì´ë„ˆ ì‹œì‘"
    echo -e "  ${GREEN}${BOLD}4)${NC} ğŸ›‘ Docker ì»¨í…Œì´ë„ˆ ì¤‘ì§€"
    echo -e "  ${GREEN}${BOLD}5)${NC} ğŸ”§ ê°œë³„ ì„œë¹„ìŠ¤ ê´€ë¦¬"
    echo ""
    echo -e "  ${YELLOW}${BOLD}0)${NC} â¬…ï¸  ë’¤ë¡œê°€ê¸°"
    echo ""
    echo -e -n "${BOLD}ì„ íƒ${NC} â¤ "
    read choice

    case $choice in
        1)
            echo ""
            ./start_all.sh
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            service_menu
            ;;
        2)
            echo ""
            ./stop_all.sh
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            service_menu
            ;;
        3)
            echo ""
            docker-compose up -d
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            service_menu
            ;;
        4)
            echo ""
            docker-compose down
            echo ""
            echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
            read -p "ì—”í„°ë¥¼ ëˆŒëŸ¬ ê³„ì†..."
            service_menu
            ;;
        5)
            individual_service_menu
            ;;
        0) show_main_menu ;;
        *)
            echo -e "${RED}âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤${NC}"
            sleep 1
            service_menu
            ;;
    esac
}

# ê°œë³„ ì„œë¹„ìŠ¤ ê´€ë¦¬
individual_service_menu() {
    print_header
    echo -e "${BOLD}${CYAN}ğŸ”§ ê°œë³„ ì„œë¹„ìŠ¤ ê´€ë¦¬${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "${GREEN}  ì‹œì‘:${NC}"
    echo -e "  ${GREEN}${BOLD}1)${NC} ğŸŸ¢ Backend API"
    echo -e "  ${GREEN}${BOLD}2)${NC} ğŸŸ¢ Celery Worker"
    echo -e "  ${GREEN}${BOLD}3)${NC} ğŸŸ¢ Celery Beat"
    echo -e "  ${GREEN}${BOLD}4)${NC} ğŸŸ¢ Frontend"
    echo ""
    echo -e "${RED}  ì¤‘ì§€:${NC}"
    echo -e "  ${RED}${BOLD}5)${NC} ğŸ”´ Backend API"
    echo -e "  ${RED}${BOLD}6)${NC} ğŸ”´ Celery Worker"
    echo -e "  ${RED}${BOLD}7)${NC} ğŸ”´ Celery Beat"
    echo -e "  ${RED}${BOLD}8)${NC} ğŸ”´ Frontend"
    echo ""
    echo -e "  ${YELLOW}${BOLD}0)${NC} â¬…ï¸  ë’¤ë¡œê°€ê¸°"
    echo ""
    echo -e -n "${BOLD}ì„ íƒ${NC} â¤ "
    read choice

    case $choice in
        1)
            echo ""
            cd backend && nohup .venv/bin/uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload > ../logs/backend.log 2>&1 &
            echo -e "${GREEN}${BOLD}âœ… Backend API ì‹œì‘ë¨${NC}"
            sleep 2
            individual_service_menu
            ;;
        2)
            echo ""
            cd backend && nohup ./run_celery_worker.sh > ../logs/worker.log 2>&1 &
            echo -e "${GREEN}${BOLD}âœ… Celery Worker ì‹œì‘ë¨${NC}"
            sleep 2
            individual_service_menu
            ;;
        3)
            echo ""
            cd backend && nohup ./run_celery_beat.sh > ../logs/beat.log 2>&1 &
            echo -e "${GREEN}${BOLD}âœ… Celery Beat ì‹œì‘ë¨${NC}"
            sleep 2
            individual_service_menu
            ;;
        4)
            echo ""
            cd frontend && nohup npm run dev > ../logs/frontend.log 2>&1 &
            echo -e "${GREEN}${BOLD}âœ… Frontend ì‹œì‘ë¨${NC}"
            sleep 2
            individual_service_menu
            ;;
        5)
            echo ""
            pkill -f "uvicorn app.main:app"
            echo -e "${RED}${BOLD}ğŸ”´ Backend API ì¤‘ì§€ë¨${NC}"
            sleep 1
            individual_service_menu
            ;;
        6)
            echo ""
            pkill -f "celery.*worker"
            echo -e "${RED}${BOLD}ğŸ”´ Celery Worker ì¤‘ì§€ë¨${NC}"
            sleep 1
            individual_service_menu
            ;;
        7)
            echo ""
            pkill -f "celery.*beat"
            echo -e "${RED}${BOLD}ğŸ”´ Celery Beat ì¤‘ì§€ë¨${NC}"
            sleep 1
            individual_service_menu
            ;;
        8)
            echo ""
            pkill -f "next-server"
            echo -e "${RED}${BOLD}ğŸ”´ Frontend ì¤‘ì§€ë¨${NC}"
            sleep 1
            individual_service_menu
            ;;
        0) service_menu ;;
        *)
            echo -e "${RED}âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤${NC}"
            sleep 1
            individual_service_menu
            ;;
    esac
}

# ë¬¸ì„œ ë©”ë‰´
docs_menu() {
    print_header
    echo -e "${BOLD}${CYAN}ğŸ“š ë¬¸ì„œ ë³´ê¸°${NC}"
    echo -e "${CYAN}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    echo -e "  ${GREEN}${BOLD}1)${NC} ğŸ“– ì‹œì‘ ê°€ì´ë“œ ${BLUE}(README_STARTUP.md)${NC}"
    echo -e "  ${GREEN}${BOLD}2)${NC} ğŸ¤– ê°œë°œ ê°€ì´ë“œ ${BLUE}(CLAUDE.md)${NC}"
    echo -e "  ${GREEN}${BOLD}3)${NC} ğŸ—„ï¸  ìŠ¤í¬ë¦½íŠ¸ ë¬¸ì„œ ${BLUE}(scripts/README.md)${NC}"
    echo -e "  ${GREEN}${BOLD}4)${NC} ğŸ§ª í…ŒìŠ¤íŠ¸ ë¬¸ì„œ ${BLUE}(tests/README.md)${NC}"
    echo -e "  ${GREEN}${BOLD}5)${NC} ğŸ—ï¸  í”„ë¡œì íŠ¸ êµ¬ì¡° ${BLUE}(docs/PROJECT_STRUCTURE.md)${NC}"
    echo -e "  ${GREEN}${BOLD}6)${NC} ğŸ› ï¸  DevTool ê°€ì´ë“œ ${BLUE}(DEVTOOL.md)${NC}"
    echo ""
    echo -e "  ${YELLOW}${BOLD}0)${NC} â¬…ï¸  ë’¤ë¡œê°€ê¸°"
    echo ""
    echo -e -n "${BOLD}ì„ íƒ${NC} â¤ "
    read choice

    case $choice in
        1)
            less README_STARTUP.md
            docs_menu
            ;;
        2)
            less CLAUDE.md
            docs_menu
            ;;
        3)
            less scripts/README.md
            docs_menu
            ;;
        4)
            less tests/README.md
            docs_menu
            ;;
        5)
            less docs/PROJECT_STRUCTURE.md
            docs_menu
            ;;
        6)
            less DEVTOOL.md
            docs_menu
            ;;
        0) show_main_menu ;;
        *)
            echo -e "${RED}âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤${NC}"
            sleep 1
            docs_menu
            ;;
    esac
}

# ë©”ì¸ ì‹¤í–‰
if [ "$1" == "--help" ] || [ "$1" == "-h" ]; then
    echo -e "${BOLD}${PURPLE}DevTool - Naver Real Estate í†µí•© ê°œë°œ ë„êµ¬${NC}"
    echo ""
    echo -e "${BOLD}ì‚¬ìš©ë²•:${NC} ./devtool [ì˜µì…˜]"
    echo ""
    echo -e "${BOLD}ì˜µì…˜:${NC}"
    echo "  (ì—†ìŒ)     ëŒ€í™”í˜• ë©”ë‰´ ì‹œì‘"
    echo "  --help     ë„ì›€ë§ í‘œì‹œ"
    echo ""
    exit 0
fi

# ëŒ€í™”í˜• ë©”ë‰´ ì‹œì‘
show_main_menu
